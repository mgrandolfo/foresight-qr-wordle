<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Foresight â€” Guess the word</title>

<style>
:root{
  --bg: #f2eef9;

  --text: #0f172a;
  --muted: #475569;

  --violet: #8f68aa;
  --pink:  #be81ad;
  --mint:  #a5dc92;
  --peach: #f2c38b;   /* present */

  --gray-light: #cbd5e1;
  --gray-dark:  #475569;

  --cell: 52px;
  --gap: 8px;
  --radius: 14px;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background:
    radial-gradient(900px 500px at 0% 0%, rgba(190,129,173,.35), transparent 60%),
    radial-gradient(800px 500px at 100% 20%, rgba(165,220,146,.25), transparent 60%),
    radial-gradient(900px 600px at 50% 100%, rgba(143,104,170,.30), transparent 60%),
    var(--bg);
  color: var(--text);
  min-height:100vh;
}

.wrap{max-width:720px;margin:auto;padding:20px 14px 36px}

.card{
  background: rgba(255,255,255,.6);
  backdrop-filter: blur(10px);
  border-radius:22px;
  padding:20px 16px 22px;
  box-shadow:0 20px 40px rgba(0,0,0,.15);
}

.brand{display:flex;justify-content:center;margin-bottom:10px}
.brand img{max-height:56px}

h1{text-align:center;margin:8px 0 18px;font-size:20px;letter-spacing:.04em}

/* board */
.board{display:grid;gap:var(--gap)}
.row{display:grid;grid-template-columns:repeat(6,var(--cell));gap:var(--gap);justify-content:center}
.cell{
  width:var(--cell);height:var(--cell);
  border-radius:var(--radius);
  display:flex;align-items:center;justify-content:center;
  font-weight:900;font-size:22px;text-transform:uppercase;
  background:white;border:2px solid rgba(143,104,170,.25);
  user-select:none;
}
.cell.reveal{transition:transform .12s ease}
.cell.reveal.pop{transform:scale(1.05)}
.cell.correct{background:var(--mint);border-color:var(--mint)}
.cell.present{background:var(--peach);border-color:var(--peach)}
.cell.absent{background:var(--gray-light);border-color:var(--gray-light)}

/* input */
.bar{display:flex;gap:10px;justify-content:center;margin-top:14px;flex-wrap:wrap}
input{
  width:240px;height:44px;border-radius:16px;
  border:2px solid rgba(143,104,170,.35);
  padding:0 12px;font-size:16px;text-transform:uppercase;
}
input:focus{outline:none;border-color:var(--mint);box-shadow:0 0 0 4px rgba(165,220,146,.25)}

button{
  height:44px;padding:0 16px;border-radius:16px;
  border:none;font-weight:800;cursor:pointer;
}
#send{background:linear-gradient(90deg,var(--violet),var(--pink));color:white}
#reset{background:#e5e7eb;color:#334155}

.msg{text-align:center;margin-top:12px;min-height:22px;font-weight:600;color:var(--muted)}

/* keyboard */
.kbd{margin-top:16px;display:grid;gap:8px}
.kbdRow{display:flex;gap:6px;justify-content:center}
.key{
  flex:1;height:44px;border-radius:14px;border:none;
  background:#e5e7eb;font-weight:800;cursor:pointer;
  user-select:none;
}
.key.wide{flex:1.4}
.key.correct{background:var(--mint)}
.key.present{background:var(--peach)}
.key.absent{background:var(--gray-dark);color:white}

/* modal */
.modalOverlay{
  position:fixed; inset:0;
  display:none;
  align-items:center; justify-content:center;
  padding: 18px;
  background: rgba(15,23,42,.35);
  backdrop-filter: blur(10px);
  z-index: 50;
}
.modal{
  width: min(520px, 100%);
  background: rgba(255,255,255,.85);
  border: 1px solid rgba(143,104,170,.25);
  border-radius: 22px;
  box-shadow: 0 24px 60px rgba(0,0,0,.22);
  padding: 18px 16px 16px;
  position: relative;
  animation: pop .18s ease-out forwards;
  text-align:center;
}
@keyframes pop{
  from { opacity: 0; transform: translateY(10px) scale(.98); }
  to   { opacity: 1; transform: translateY(0) scale(1); }
}
.modalClose{
  position:absolute; top:10px; right:10px;
  width: 40px; height: 40px;
  border-radius: 14px;
  border: none;
  background: rgba(15,23,42,.08);
  color: var(--text);
  font-size: 18px;
  font-weight: 900;
  cursor: pointer;
}
.modalTitle{ font-size:18px; font-weight:1000; margin-top:6px; }
.modalSub{ margin-top:6px; color:var(--muted); font-weight:650; }
.modalActions{ display:flex; justify-content:center; gap:12px; flex-wrap:wrap; margin-top:14px; }

.modalLink{
  display:inline-block;
  padding: 12px 18px;
  border-radius: 16px;
  font-weight: 1000;
  text-decoration:none;
  color:#0f172a;
  background: linear-gradient(90deg,var(--mint),#ffd8a8);
  box-shadow: 0 14px 28px rgba(0,0,0,.12);
}
.modalBtn{
  padding: 12px 18px;
  border-radius: 16px;
  border:none;
  font-weight: 1000;
  cursor:pointer;
  background: linear-gradient(90deg,var(--violet),var(--pink));
  color:white;
  height:auto;
}
</style>
</head>

<body>
<div class="wrap">
  <div class="card">
    <div class="brand">
      <img src="foresight_color-01.png" alt="Foresight">
    </div>

    <h1>Guess the word</h1>

    <div id="board" class="board"></div>

    <div class="bar">
      <input id="guess" maxlength="6" autocomplete="off" />
      <button id="send" type="button">Submit</button>
      <button id="reset" type="button">Reset</button>
    </div>

    <div id="msg" class="msg"></div>

    <!-- âœ… Keyboard is now static HTML: it cannot disappear -->
    <div id="kbd" class="kbd" aria-label="Keyboard">
      <div class="kbdRow">
        <button class="key" data-key="Q" type="button">Q</button>
        <button class="key" data-key="W" type="button">W</button>
        <button class="key" data-key="E" type="button">E</button>
        <button class="key" data-key="R" type="button">R</button>
        <button class="key" data-key="T" type="button">T</button>
        <button class="key" data-key="Y" type="button">Y</button>
        <button class="key" data-key="U" type="button">U</button>
        <button class="key" data-key="I" type="button">I</button>
        <button class="key" data-key="O" type="button">O</button>
        <button class="key" data-key="P" type="button">P</button>
      </div>

      <div class="kbdRow">
        <button class="key" data-key="A" type="button">A</button>
        <button class="key" data-key="S" type="button">S</button>
        <button class="key" data-key="D" type="button">D</button>
        <button class="key" data-key="F" type="button">F</button>
        <button class="key" data-key="G" type="button">G</button>
        <button class="key" data-key="H" type="button">H</button>
        <button class="key" data-key="J" type="button">J</button>
        <button class="key" data-key="K" type="button">K</button>
        <button class="key" data-key="L" type="button">L</button>
      </div>

      <div class="kbdRow">
        <button class="key wide" data-key="GO" type="button">GO</button>
        <button class="key" data-key="Z" type="button">Z</button>
        <button class="key" data-key="X" type="button">X</button>
        <button class="key" data-key="C" type="button">C</button>
        <button class="key" data-key="V" type="button">V</button>
        <button class="key" data-key="B" type="button">B</button>
        <button class="key" data-key="N" type="button">N</button>
        <button class="key" data-key="M" type="button">M</button>
        <button class="key wide" data-key="BKSP" type="button">âŒ«</button>
      </div>
    </div>
  </div>
</div>

<!-- WIN Popup -->
<div id="winOverlay" class="modalOverlay" role="dialog" aria-modal="true" aria-labelledby="winTitle">
  <div class="modal">
    <button class="modalClose" id="winClose" aria-label="Close" type="button">âœ•</button>
    <div class="modalTitle" id="winTitle">Congrats! ðŸŽ‰</div>
    <div class="modalSub">Visit our website:</div>
    <div class="modalActions">
      <a id="unlockLink" class="modalLink" href="#" target="_blank" rel="noopener">Open website</a>
    </div>
  </div>
</div>

<!-- LOSE Popup -->
<div id="loseOverlay" class="modalOverlay" role="dialog" aria-modal="true" aria-labelledby="loseTitle">
  <div class="modal">
    <button class="modalClose" id="loseClose" aria-label="Close" type="button">âœ•</button>
    <div class="modalTitle" id="loseTitle">Almost ðŸ™‚</div>
    <div class="modalActions">
      <button id="tryAgainBtn" class="modalBtn" type="button">Try again</button>
    </div>
  </div>
</div>

<script>
const SECRET_WORD = "IMPACT";
const UNLOCK_URL  = "https://foresightst.com/";
const MAX_TRIES = 6, WORD_LEN = 6;

let tries = [];
let finished = false;
const keyState = {}; // letter -> correct/present/absent

const boardEl = document.getElementById("board");
const inputEl = document.getElementById("guess");
const msgEl = document.getElementById("msg");

const winOverlay = document.getElementById("winOverlay");
const loseOverlay = document.getElementById("loseOverlay");

document.getElementById("unlockLink").href = UNLOCK_URL;

function openWin(){ winOverlay.style.display = "flex"; }
function closeWin(){ winOverlay.style.display = "none"; }
function openLose(){ loseOverlay.style.display = "flex"; }
function closeLose(){ loseOverlay.style.display = "none"; }

document.getElementById("winClose").addEventListener("click", closeWin);
winOverlay.addEventListener("click", (e)=>{ if(e.target===winOverlay) closeWin(); });

document.getElementById("loseClose").addEventListener("click", closeLose);
loseOverlay.addEventListener("click", (e)=>{ if(e.target===loseOverlay) closeLose(); });

document.addEventListener("keydown", (e)=>{
  if(e.key === "Escape"){ closeWin(); closeLose(); }
});

function sanitize(s){
  return (s || "").toUpperCase().replace(/[^A-Z]/g,"").slice(0, WORD_LEN);
}

function buildBoard(){
  boardEl.innerHTML = "";
  for(let r=0;r<MAX_TRIES;r++){
    const row = document.createElement("div");
    row.className = "row";
    for(let c=0;c<WORD_LEN;c++){
      const cell = document.createElement("div");
      cell.className = "cell";
      cell.dataset.r = r;
      cell.dataset.c = c;
      row.appendChild(cell);
    }
    boardEl.appendChild(row);
  }
}

function evaluate(guess){
  const res = Array(WORD_LEN).fill("absent");
  const secretArr = SECRET_WORD.split("");
  const guessArr = guess.split("");

  for(let i=0;i<WORD_LEN;i++){
    if(guessArr[i] === secretArr[i]){
      res[i] = "correct";
      secretArr[i] = null;
      guessArr[i] = null;
    }
  }
  for(let i=0;i<WORD_LEN;i++){
    if(guessArr[i] == null) continue;
    const idx = secretArr.indexOf(guessArr[i]);
    if(idx !== -1){
      res[i] = "present";
      secretArr[idx] = null;
    }
  }
  return res;
}

function paintRow(rowIndex, guess, evals){
  for(let i=0;i<WORD_LEN;i++){
    const cell = boardEl.querySelector(`.cell[data-r="${rowIndex}"][data-c="${i}"]`);
    cell.textContent = guess[i] || "";
    cell.classList.add("reveal");
    setTimeout(()=>cell.classList.add("pop"), 10);
    setTimeout(()=>cell.classList.remove("pop"), 160);
    cell.classList.remove("correct","present","absent");
    cell.classList.add(evals[i]);
  }
}

function rank(st){
  return st === "correct" ? 3 : st === "present" ? 2 : st === "absent" ? 1 : 0;
}

function updateKeyboard(guess, evals){
  for(let i=0;i<WORD_LEN;i++){
    const letter = guess[i];
    const st = evals[i];
    const prev = keyState[letter];
    if(rank(st) > rank(prev)) keyState[letter] = st;
  }

  document.querySelectorAll("#kbd .key").forEach(btn=>{
    const k = btn.dataset.key;
    // only letters get colored
    if(!/^[A-Z]$/.test(k)) return;
    btn.classList.remove("correct","present","absent");
    if(keyState[k]) btn.classList.add(keyState[k]);
  });
}

function clearKeyboard(){
  for(const k in keyState) delete keyState[k];
  document.querySelectorAll("#kbd .key").forEach(btn=>{
    btn.classList.remove("correct","present","absent");
  });
}

function resetGame(){
  tries = [];
  finished = false;
  msgEl.textContent = "";
  inputEl.value = "";
  clearKeyboard();
  buildBoard();
  closeLose();
  inputEl.focus();
}

function submit(){
  if(finished) return;

  const guess = sanitize(inputEl.value);
  if(guess.length !== WORD_LEN) return;

  const rowIndex = tries.length;
  const evals = evaluate(guess);

  paintRow(rowIndex, guess, evals);
  updateKeyboard(guess, evals);

  tries.push(guess);
  inputEl.value = "";
  inputEl.focus();

  if(guess === SECRET_WORD){
    finished = true;
    openWin();
  } else if(tries.length >= MAX_TRIES){
    finished = true;
    openLose();
  }
}

document.getElementById("send").addEventListener("click", submit);
document.getElementById("reset").addEventListener("click", resetGame);
document.getElementById("tryAgainBtn").addEventListener("click", resetGame);

/* Keyboard clicks (event delegation) */
document.getElementById("kbd").addEventListener("click", (e)=>{
  const btn = e.target.closest("button");
  if(!btn) return;
  if(finished) return;

  const k = btn.dataset.key;

  if(k === "GO"){ submit(); return; }
  if(k === "BKSP"){
    inputEl.value = inputEl.value.slice(0, -1);
    inputEl.focus();
    return;
  }
  if(/^[A-Z]$/.test(k)){
    const cur = sanitize(inputEl.value);
    if(cur.length < WORD_LEN){
      inputEl.value = cur + k;
      inputEl.focus();
    }
  }
});

/* Physical keyboard */
document.addEventListener("keydown", (e)=>{
  if(finished) return;

  if(e.key === "Enter"){ submit(); return; }
  if(e.key === "Backspace"){
    inputEl.value = inputEl.value.slice(0, -1);
    return;
  }

  const ch = e.key.toUpperCase();
  if(/^[A-Z]$/.test(ch)){
    const cur = sanitize(inputEl.value);
    if(cur.length < WORD_LEN) inputEl.value = cur + ch;
  }
});

/* init */
buildBoard();
inputEl.focus();
</script>
</body>
</html>
